import t,{useRef as e,useState as n,useEffect as o,Children as r}from"react";import i,{css as l}from"styled-components";const c={boxShadow:"#000000 0px 1px 3px 0px",borderRadius:4,overflow:"hidden",display:"flex",flexDirection:"column"};function s({children:e,layout:n}){const o=function(t){return"default"===t?{width:500,height:500,maxWidth:"100%"}:"fit"===t?{maxWidth:"100%"}:void 0}(n);return t.createElement("div",{style:Object.assign(Object.assign({},c),o)},e)}const d="react-draw-cursor",a={light:"#bddefb",main:"#228be6"},u={light:"#ececec"},h={width:"calc(100% + 16px)",height:"calc(100% + 16px)",position:"absolute",border:`2px dotted ${a.main}`,top:"-6px",left:"-6px",cursor:"all-scroll",pointerEvents:"all"},p={top:"-45px",cursor:"grab",left:"calc(50% - 8px)"},f={width:"0px",height:"35px",borderLeft:"2px dotted black",position:"absolute",left:"5px",pointerEvents:"none"},m={position:"absolute",borderRadius:"50%",width:"16px",height:"16px"},w=i.button`
  display: flex;
  cursor: pointer;
  justify-content: center;
  align-items: center;
  border: none;
  background-color: transparent;
  border-radius: 2px;
  transition: background-color 150ms ease-in-out;
  @media only screen and (min-width: ${450}px) {
    width: 40px;
    height: 40px;
  }
  @media only screen and (max-width: ${450}px) {
    width: 30px;
    height: 30px;
  }
  &:hover {
    background-color: ${u.light};
  }
  ${t=>t.selected&&l`
      background-color: ${a.main} !important;
      > svg path {
        fill: white;
      }
    `}
`;function g({children:e,selected:n,onSelect:o}){return t.createElement(w,{selected:n,onClick:o},e)}const v=i.div`
  display: flex;
  background-color: ${a.light};
  z-index: 1000;
`;function b({tools:e,onSelectTool:n,currentTool:o}){return t.createElement(v,null,e.map((e=>t.createElement(g,{key:e.id,selected:e.id===o,onSelect:()=>n(e.id)},e.icon))))}function y(t){for(var e="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=n.length,r=0;r<t;r++)e+=n.charAt(Math.floor(Math.random()*o));return e}function x(t){let e=t.touches[0];return e||(e=t.targetTouches[0]),e||(e=t.changedTouches[0]),[e.clientX,e.clientY]}function E(t,e){if(!e)throw new Error("Container not set.");const n=e.getBoundingClientRect();return[t[0]-n.left,t[1]-n.top]}function C(){return void 0!==typeof window}function M(t,e,n){if(!C())throw new Error("new bounding div called on the server.");const[o,r]=t,{id:i,div:l,top:c,left:s,right:d,bottom:a}=function(t,e,n,o){const r=y(6),i=document.createElement("div"),l=t-n,c=e-n;return i.id=`${o}-${r}`,i.style.width=2*n+"px",i.style.height=2*n+"px",i.style.position="absolute",i.style.left=l+"px",i.style.top=c+"px",i.style.pointerEvents="none",i.style.zIndex="1",{div:i,id:r,top:c,left:l,right:l+n+n,bottom:c+n+n}}(o,r,e,n);return{coords:[t],element:null,toolId:n,container:{id:i,div:l,bounds:{top:c,left:s,right:d,bottom:a}},style:{zIndex:1,lineWidth:e},customData:null}}function L(t,e){const{width:n,height:o}=function(t){const e=t.getAttribute("viewbox");if(!e)throw new Error("no viewbox found on ele");const n=e.split(" ");return{width:parseFloat(n[2]),height:parseFloat(n[3])}}(t),r=(e.right-e.left)/n,i=(e.bottom-e.top)/o;t.lastElementChild.style.transform=`scale(${r}, ${i})`}function D(t,e,n){const o=e.div.getBoundingClientRect(),r=n.getBoundingClientRect(),i=o.top-r.top,l=t[1]-i,c=o.left-r.left;return[t[0]-c,l]}function z(t){if(t.coords.length<2)throw new Error("data coords must be at least length 2");const[e,n]=t.coords[0],[o,r]=t.coords[t.coords.length-1],i=t.style.lineWidth,l=Math.min(e,o),c=Math.min(n,r),s=Math.max(e,o),d=Math.max(n,r),{bounds:a,div:u}=t.container;return a.left=l,a.right=s,a.top=c,a.bottom=d,u.style.top=c+"px",u.style.left=l+"px",u.style.width=`${s-l+i}px`,u.style.height=`${d-c+i}px`,t.coords}function S(t,e){return t.top<=e.top&&t.bottom>=e.bottom&&t.left<=e.left&&t.right>=e.right}function j(t){const e=t.container.div,n=t.container.id;if(function(t){return null!==t.querySelector('[id^="select-frame"')}(e))return null;const o=document.createElement("div");return o.setAttribute("id",`select-frame-${n}`),I(o,h),o}function O(t){const e=j(t);e&&(!function(t,e){const n=$(e,!0,!1,!1,!0),o=$(e,!0,!0),r=$(e,!1,!0,!0),i=$(e,!1,!1,!0,!0);t.appendChild(n),t.appendChild(o),t.appendChild(r),t.appendChild(i);const l=$(e);l.id=`button-rotate-${e}`,I(l,p);const c=document.createElement("div");I(c,f),c.id=`line-div-${e}`,l.appendChild(c),t.appendChild(l)}(e,t.container.id),t.container.div.appendChild(e))}function $(t,e,n,o,r){const i=document.createElement("button");I(i,m);let l="";return e?(i.style.top="-12px",l+="n"):o&&(i.style.bottom="-12px",l+="s"),n?(i.style.right="-12px",l+="e"):r&&(i.style.left="-12px",l+="w"),i.id=`corner-button-${l}-${t}`,i.style.cursor=`${l}-resize`,i}function A(t){const{div:e,id:n}=t.container,o=e.querySelector('[id^="select-frame"');null!==o&&e.removeChild(o)}function I(t,e){for(const n in e)t.style[n]=e[n];return t}function T(i){var{children:l,topBarTools:c,hideTopBar:a}=i,u=function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(t);r<o.length;r++)e.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(n[o[r]]=t[o[r]])}return n}(i,["children","topBarTools","hideTopBar"]);const h=e(null),[p,f]=n(c[0]),{layout:m}=function(t,e){const n=r.count(t);if(n>1)throw new Error("ReactDraw expects either 0 or 1 children, detected more.");void 0===e&&(e="default");return{numChildren:n,layout:e}}(l,u.layout),w=e({}),g=e(null),[v,C]=n(4),L=e(`drawing-area-container-${y(6)}`),D=e([]),z=e(null),$=e(null),I=()=>{const t=h.current;if(!t)throw new Error("no view container while resizing");return t},T=()=>d===p.id,R=()=>null!==z.current&&null!==$.current,N=(t,e,n)=>{const o=(r=n.newPoint,i=n.previousPoint,[r[0]-i[0],r[1]-i[1]]);var r,i;const l=k(c,e.toolId);if(l.doResize)l.doResize(e,n);else if("resize-ne"===t)!function(t,e){const[n,o]=e,r=t.container,i=r.bounds,l=r.div;i.left+5>=i.right+n||i.bottom-5<=i.top+o?console.log("got here"):(i.top+=o,i.right+=n,l.style.top=i.top+"px",l.style.width=i.right-i.left+"px",l.style.height=i.bottom-i.top+"px")}(e,o);else if("resize-nw"===t)!function(t,e){const[n,o]=e,r=t.container,i=r.bounds,l=r.div;i.left+n>=i.right-5||i.bottom-5<=i.top+o||(i.top+=o,i.left+=n,l.style.top=i.top+"px",l.style.left=i.left+"px",l.style.width=i.right-i.left+"px",l.style.height=i.bottom-i.top+"px")}(e,o);else if("resize-se"===t)!function(t,e){const[n,o]=e,r=t.container,i=r.bounds,l=r.div;i.left+5>=i.right+n||i.bottom+o<=i.top+5||(i.right+=n,i.bottom+=o,l.style.width=i.right-i.left+"px",l.style.height=i.bottom-i.top+"px")}(e,o);else{if("resize-sw"!==t)throw new Error("resize mode not recognized");!function(t,e){const[n,o]=e,r=t.container,i=r.bounds,l=r.div;i.left+n>=i.right-5||i.bottom+o<=i.top+5||(i.bottom+=o,i.left+=n,l.style.left=i.left+"px",l.style.width=i.right-i.left+"px",l.style.height=i.bottom-i.top+"px")}(e,o)}l.onResize(e,n)},W=(t,e,n)=>{if("rotate"===t){return function(t,e,n){const o=t.container.div,r=e[0]-n[0],i=e[1]-n[1],l=180*Math.atan2(i,r)/Math.PI+90;o.style.transform=`rotate(${l}deg)`}(e,n,function(t){const e=t.bottom-t.top,n=t.top+e/2,o=t.right-t.left;return[t.left+o/2,n]}(e.container.bounds)),!0}return!1},B=t=>{const{tool:e,ctx:n}=F(t.toolId);e&&n&&e.onAfterUpdate&&e.onAfterUpdate(t,n)},Z=t=>{const e=z.current;if(!e)return;const{objects:n}=tt(),o=$.current;if(null===o)return;if("drag"===o)return function(t,e,n){const[o,r]=n,[i,l]=e,c=o-i,s=r-l;for(const e of t){const{bounds:t,div:n}=e.container,{left:o,top:r,right:i,bottom:l}=t;t.left=o+c,t.top=r+s,t.right=t.left+(i-o),t.bottom=t.top+(l-r),n.style.top=t.top+"px",n.style.left=t.left+"px"}}(n,e,t),void(1===n.length&&B(n[0]));!function(t){if(t.length>1)throw new Error("should not be able to preform this action on more than object")}(n);const r=n[0];if(W(o,r,t))return B(r);N(o,r,{viewContainer:I(),previousPoint:e,newPoint:t,mode:o}),B(r)};function P(t,e,n){const o=I();if(G(t,e))return;T()&&n||_();const r=M(e,v,p.id);g.current=r,o.append(r.container.div),p.onDrawStart(r,o)}function U(t){const e=g.current;if(R()||!e)return;const n=I();e.coords.push(t),p.onDrawing(e,n),d===p.id&&X(e,w.current)}function Y(t,e){const n=g.current;$.current=null,z.current=null,g.current=null,n&&(p.onDrawEnd(n,I()),T()?H(n,t,e):w.current[n.container.id]=n)}const H=(t,e,n)=>{const o=t.coords[0];if(r=e,i=o,Math.sqrt(Math.pow(Math.abs(r[0]-i[0]),2)+Math.pow(Math.abs(r[1]-i[1]),2))<75){const t=function(t,e){let{top:n,right:o,bottom:r,left:i}=t;const[l,c]=e;return c>r?r=c:c<n&&(n=c),l<i?i=l:l>o&&(o=l),{top:n,right:o,bottom:r,left:i}}(function(t){const[e,n]=t;return{top:n,right:e,bottom:n,left:e}}(o),e);K(w.current,t,n)}var r,i},G=(t,e)=>{if(!t)throw new Error("Did start select action recieved null as target");return t.id.includes("select-frame")?(z.current=e,$.current="drag",!0):t.id.includes("button-rotate")?(z.current=e,$.current="rotate",!0):!!t.id.includes("corner-button")&&(z.current=e,$.current=function(t){const e=t.split("-")[2];if("sw"===e)return"resize-sw";if("nw"===e)return"resize-nw";if("se"===e)return"resize-se";if("ne"===e)return"resize-ne";throw new Error("corner mode id not valid")}(t.id),!0)};function Q(t){R()&&(Z(t),z.current=t)}o((()=>{const t=h.current;if(t)return t.addEventListener("mousedown",r),t.addEventListener("mouseup",l),t.addEventListener("mousemove",i),t.addEventListener("touchstart",c,{passive:!1}),t.addEventListener("touchmove",s,{passive:!1}),t.addEventListener("touchcancel",d),t.addEventListener("touchend",d),t.addEventListener("mouseleave",l),window.addEventListener("mousemove",e),window.addEventListener("mouseup",o),window.addEventListener("touchmove",n,{passive:!1}),window.addEventListener("touchend",o),window.addEventListener("touchcancel",o),()=>{t.removeEventListener("mousedown",r),t.removeEventListener("mouseup",l),t.removeEventListener("mousemove",i),t.removeEventListener("touchstart",c),t.removeEventListener("touchmove",s),t.removeEventListener("touchcancel",d),t.removeEventListener("touchend",d),t.removeEventListener("mouseleave",l),window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",o),window.removeEventListener("touchmove",n),window.removeEventListener("touchend",o),window.removeEventListener("touchcancel",o)};function e(e){Q(E([e.clientX,e.clientY],t))}function n(e){Q(E(x(e),t))}function o(){$.current=null,z.current=null}function r(e){const n=E([e.clientX,e.clientY],t);P(e.target,n,e.shiftKey)}function i(e){U(E([e.clientX,e.clientY],t))}function l(e){Y(E([e.clientX,e.clientY],t),e.shiftKey)}function c(e){e.preventDefault();const n=E(x(e),t);P(e.target,n,e.shiftKey)}function s(e){e.preventDefault();U(E(x(e),t))}function d(e){e.preventDefault();Y(E(x(e),t),e.shiftKey)}}),[p]);const X=(t,e)=>{const n=function(t,e){const n=[];for(const o in t){const r=t[o];A(r),S(e,r.container.bounds)&&n.push(o)}return n}(e,t.container.bounds);q(n)},K=(t,e,n)=>{const o=function(t,e){var n;let o=null;for(const r in t){const i=t[r];if(S(i.container.bounds,e)){(null!==(n=null==o?void 0:o.style.zIndex)&&void 0!==n?n:0<i.style.zIndex)&&(o=i)}}return o}(t,e);let{ids:r}=_();n||(r=[]),null!==o&&(r=r.concat([o.container.id])),q(r)},q=t=>{D.current=t;const e=J(t);return 1===e.length?(V(e[0]),O(e[0])):e.length>1?function(t){for(const e of t){const t=j(e);t&&e.container.div.appendChild(t)}}(e):void 0},V=t=>{const{tool:e,ctx:n}=F(t.toolId);e&&n&&e.onSelect&&e.onSelect(t,n)},F=t=>{const e=k(c,t);if(!e)return{tool:null,ctx:null};if(!h.current)return{tool:e,ctx:null};return{tool:e,ctx:{viewContainer:h.current}}},J=t=>t.map((t=>w.current[t])),_=()=>{const{objects:t,ids:e}=tt();if(function(t){for(const e of t)A(e)}(t),1===t.length){const{tool:e,ctx:n}=F(t[0].toolId);e&&n&&e.onUnSelect&&e.onUnSelect(t[0],n)}return $.current=null,z.current=null,D.current=[],{ids:e,objects:t}},tt=()=>{const t=D.current;return{objects:J(t),ids:t}};return t.createElement(s,{layout:m},!a&&t.createElement(b,{tools:c,onSelectTool:t=>{if(p.id!==t){const e=k(c,t);e&&f(e)}t!==d&&_()},currentTool:p.id}),t.createElement("div",{id:L.current,style:{position:"relative",width:"100%",flex:1,boxSizing:"border-box"},ref:h},l),t.createElement("div",null),t.createElement("style",null,`\n\t\t#${L.current} {\n\t\t\tcursor: ${p.cursor||"defautl"};\n\t\t}\n\t  `))}function k(t,e){const n=t.find((t=>t.id===e));if(!n)throw new Error("could not find the used tool");return n}function R(t){const{size:e,width:n,height:o,color:r}=t,i=function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(t);r<o.length;r++)e.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(n[o[r]]=t[o[r]])}return n}(t,["size","width","height","color"]);return Object.assign({width:n||e||20,height:o||e||20,color:r||"#111827"},i)}function N(t){const e=document.createElementNS("http://www.w3.org/2000/svg","path");return e.setAttribute("fill","transparent"),e.setAttribute("stroke","black"),e.style.strokeWidth=`${t}px`,e.setAttribute("stroke-linejoin","round"),e.setAttribute("stroke-linecap","round"),e}function W(t,e){if(!C())throw new Error("createSVG called on server");const n=document.createElementNS("http://www.w3.org/2000/svg","svg");return n.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),n.setAttribute("viewbox",`0 0 ${t} ${e}`),n.style.position="absolute",n.style.top="0",n.style.left="0",n.style.width="100%",n.style.height="100%",n}function B(t){if(!C())throw new Error("createPath called on server");const e=document.createElementNS("http://www.w3.org/2000/svg","circle");return e.setAttribute("fill","black"),e.setAttribute("cx",`${Math.ceil(t/2)}`),e.setAttribute("cy",`${Math.ceil(t/2)}`),e.setAttribute("r",`${t}`),e}const Z={id:"free-draw-tool",icon:t.createElement((function(e){const n=R(e);return t.createElement("svg",Object.assign({},n,{viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"}),t.createElement("path",{d:"M10.5858 0.585786C11.3668 -0.195262 12.6332 -0.195262 13.4142 0.585786C14.1953 1.36683 14.1953 2.63316 13.4142 3.41421L12.6213 4.20711L9.79289 1.37868L10.5858 0.585786Z",fill:n.color}),t.createElement("path",{d:"M8.37868 2.79289L0 11.1716V14H2.82842L11.2071 5.62132L8.37868 2.79289Z",fill:n.color}))}),null),onDrawStart:t=>{const e=t.style.lineWidth,n=W(e,e),o=B(e/2);n.appendChild(o),t.container.div.appendChild(n),t.element=n},onDrawing:(t,e)=>{!function(t){let e=!1;const[n,o]=t.coords[t.coords.length-1],r=t.container,i=r.bounds,l=t.style.lineWidth;n-l<=i.left?(i.left=n-l,r.div.style.left=n-l+"px",r.div.style.width=i.right+2*l-n+"px",e=!0):n+l>=i.right&&(i.right=n+l,r.div.style.width=n+2*l-i.left+"px",e=!0),o+l>=i.bottom?(i.bottom=o+l,r.div.style.height=o+2*l-i.top+"px",e=!0):o-l<=i.top&&(i.top=o-l,r.div.style.top=o-l+"px",r.div.style.height=i.bottom+2*l-o+"px",e=!0)}(t);const n=function(t){const e=t.container.bounds;return{width:e.right-e.left,height:e.bottom-e.top}}(t),o=W(n.width,n.height),r=function(t,e){const n=N(t.style.lineWidth);return n.setAttribute("d",function(t,e){let n="",o=t.coords[0];for(let r=0;r<t.coords.length;r++){const i=D(t.coords[r],t.container,e);n+=P(i,o,r),o=i,r!==t.coords.length-1&&(n+=" ")}return n}(t,e)),n}(t,e);o.appendChild(r),t.container.div.innerHTML="",t.container.div.appendChild(o),t.element=o},onDrawEnd:t=>{console.log("free draw end")},onResize:(t,e)=>{t.element&&L(t.element,t.container.bounds)},cursor:"url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAxNCAxNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEwLjU4NTggMC41ODU3ODZDMTEuMzY2OCAtMC4xOTUyNjIgMTIuNjMzMiAtMC4xOTUyNjIgMTMuNDE0MiAwLjU4NTc4NkMxNC4xOTUzIDEuMzY2ODMgMTQuMTk1MyAyLjYzMzE2IDEzLjQxNDIgMy40MTQyMUwxMi42MjEzIDQuMjA3MTFMOS43OTI4OSAxLjM3ODY4TDEwLjU4NTggMC41ODU3ODZaIiBmaWxsPSIjMTExODI3Ii8+CjxwYXRoIGQ9Ik04LjM3ODY4IDIuNzkyODlMMCAxMS4xNzE2VjE0SDIuODI4NDJMMTEuMjA3MSA1LjYyMTMyTDguMzc4NjggMi43OTI4OVoiIGZpbGw9IiMxMTE4MjciLz4KPC9zdmc+') 0 16, pointer"};function P(t,e,n){return 0===n?`M ${t[0]} ${t[1]}`:`l ${t[0]-e[0]} ${t[1]-e[1]}`}const U={icon:t.createElement((function(e){const n=R(e);return t.createElement("svg",Object.assign({},n,{viewBox:"0 0 17 17",fill:"none",xmlns:"http://www.w3.org/2000/svg"}),t.createElement("path",{d:"M5.67175 0.911473C5.52881 0.378007 4.98047 0.0614245 4.44701 0.204366C3.91354 0.347308 3.59696 0.895645 3.7399 1.42911L3.99872 2.39504C4.14166 2.9285 4.69 3.24509 5.22346 3.10214C5.75693 2.9592 6.07351 2.41086 5.93057 1.8774L5.67175 0.911473Z",fill:n.color}),t.createElement("path",{d:"M1.42911 3.7399C0.895645 3.59696 0.347308 3.91354 0.204366 4.44701C0.0614245 4.98047 0.378007 5.52881 0.911473 5.67175L1.8774 5.93057C2.41086 6.07351 2.9592 5.75693 3.10214 5.22346C3.24509 4.69 2.9285 4.14166 2.39504 3.99872L1.42911 3.7399Z",fill:n.color}),t.createElement("path",{d:"M10.2426 3.17149C10.6331 2.78097 10.6331 2.1478 10.2426 1.75728C9.85204 1.36676 9.21887 1.36676 8.82835 1.75728L8.12124 2.46439C7.73072 2.85491 7.73072 3.48808 8.12124 3.8786C8.51177 4.26912 9.14493 4.26912 9.53545 3.8786L10.2426 3.17149Z",fill:n.color}),t.createElement("path",{d:"M3.17149 10.2426L3.8786 9.53546C4.26912 9.14493 4.26912 8.51177 3.8786 8.12124C3.48808 7.73072 2.85491 7.73072 2.46439 8.12124L1.75728 8.82835C1.36676 9.21887 1.36676 9.85204 1.75728 10.2426C2.1478 10.6331 2.78097 10.6331 3.17149 10.2426Z",fill:n.color}),t.createElement("path",{d:"M6.37142 5.07152C6 4.92295 5.57578 5.01002 5.29292 5.29289C5.01006 5.57575 4.92298 5.99997 5.07155 6.37138L9.07155 16.3714C9.2178 16.737 9.56502 16.9828 9.95847 16.9991C10.3519 17.0155 10.7183 16.7994 10.8945 16.4472L12.274 13.6882L15.2929 16.7071C15.6834 17.0976 16.3166 17.0976 16.7071 16.7071C17.0977 16.3166 17.0977 15.6834 16.7071 15.2929L13.6882 12.2739L16.4472 10.8944C16.7995 10.7183 17.0155 10.3519 16.9992 9.95843C16.9828 9.56498 16.737 9.21777 16.3714 9.07152L6.37142 5.07152Z",fill:n.color}))}),{style:{transform:"translate(-2px, -1px)"}}),id:d,onDrawStart:t=>{t.container.div.style.border=`1px solid ${a.main}`,t.container.div.style.backgroundColor=a.light+"4d"},onDrawing:t=>{z(t),t.coords.splice(1)},onDrawEnd:t=>{var e;const n=t.container.div;n.style.border="none",n.style.backgroundColor="transparent",null===(e=n.parentElement)||void 0===e||e.removeChild(n),console.log("select tool end");const o=document.getElementById(t.container.id);o&&o.remove()},onResize:t=>{}},Y={id:"react-draw-square-tool",icon:t.createElement((function(e){const n=R(e);return t.createElement("svg",Object.assign({},n,{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"}),t.createElement("rect",{width:"16",height:"16",rx:"1",fill:n.color}))}),null),onDrawStart:t=>{const e=function(t){const e=document.createElement("div");return e.style.width="100%",e.style.height="100%",e.style.border=`${t}px solid black`,e.style.borderRadius="2px",e}(t.style.lineWidth);t.container.div.appendChild(e),t.element=e},onDrawing:t=>{z(t),t.coords.splice(1)},onDrawEnd:t=>{},onResize(t,e){}};const H={id:"react-draw-circle-tool",icon:t.createElement((function(e){const n=R(e);return t.createElement("svg",Object.assign({},n,{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"}),t.createElement("circle",{cx:"8",cy:"8",r:"8",fill:n.color}))}),null),onDrawStart:t=>{const e=function(t){const e=document.createElement("div");return e.style.width="100%",e.style.height="100%",e.style.border=`${t}px solid black`,e.style.borderRadius="50%",e}(t.style.lineWidth);t.container.div.appendChild(e),t.element=e},onDrawing:t=>{z(t),t.coords.splice(1)},onDrawEnd:t=>{},onResize(t,e){}};const G={id:"react-draw-diamond-tool",icon:t.createElement((function(e){const n=R(e);return t.createElement("svg",Object.assign({},n,{viewBox:"0 0 22 22",fill:"none",xmlns:"http://www.w3.org/2000/svg"}),t.createElement("rect",{x:"11",y:"-0.313721",width:"16",height:"16",rx:"1",transform:"rotate(45 11 -0.313721)",fill:n.color}))}),null),onDrawStart:t=>{const e=t.container.div,n=Q(t);e.appendChild(n)},onDrawing:t=>{z(t);const e=t.container.div,n=Q(t);e.innerHTML="",e.appendChild(n),t.element=n,t.coords.splice(1)},onDrawEnd:t=>{},onResize(t,e){L(t.element,t.container.bounds)}};function Q(t){const e=t.style.lineWidth,{bounds:n}=t.container,o=W(n.right-n.left+e,n.bottom-n.top+e),r=function(t,e){const n=N(e);return n.setAttribute("d",function(t,e){const n=t.bottom-t.top,o=t.right-t.left,r=`${e/2} ${n/2}`;return`M ${r} L ${o/2} ${e/2} L ${o-e/2} ${n/2} L ${o/2} ${n-e/2} L ${r}`}(t,e)),n}(n,t.style.lineWidth);return o.appendChild(r),o}const X={id:"react-draw-line-tool",icon:t.createElement((function(e){const n=R(e);return t.createElement("svg",Object.assign({},n,{viewBox:"0 0 24 3",fill:"none",xmlns:"http://www.w3.org/2000/svg"}),t.createElement("line",{y1:"1.5",x2:"24",y2:"1.5",stroke:"black",strokeWidth:"3"}))}),null),onDrawStart:t=>{const e=t.container.div,n=t.style.lineWidth,o=W(n,n),r=B(n/2);o.appendChild(r),e.append(o),t.element=o,t.customData={}},onDrawing:(t,e)=>{z(t);const n=function(t,e){const[n,o]=t,[r,i]=e;if(r===n)return i>o?"down":"up";if(i===o)return r>n?"right":"left";if(r<n&&i<o)return"nw";if(r>n&&i<o)return"ne";if(r>n&&i>o)return"se";return"sw"}(t.coords[0],t.coords[t.coords.length-1]);t.customData.orientation=n;const o=K(t,n),r=t.container.div;r.innerHTML="",r.appendChild(o),t.element=o,t.coords.splice(1)},onDrawEnd:t=>{},onResize(t,e){const n=K(t,t.customData.orientation),o=t.container.div;o.removeChild(t.element),console.log(),o.appendChild(n),t.element=n,t.coords.splice(1)}};function K(t,e){const{bounds:n}=t.container,o=n.right-n.left,r=n.bottom-n.top,i=W(o,r);i.style.overflow="visible";const[l,c]=function(t,e,n){if("right"===n)return[[0,0],[t,0]];if("left"===n)return[[t,0],[0,0]];if("down"===n)return[[0,0],[0,e]];if("up"===n)return[[0,e],[0,0]];if("nw"===n)return[[t,e],[0,0]];if("ne"===n)return[[0,e],[t,0]];if("se"===n)return[[0,0],[t,e]];return[[t,0],[0,e]]}(o,r,e),s=function(t){const e=document.createElementNS("http://www.w3.org/2000/svg","line");return e.setAttribute("fill","transparent"),e.setAttribute("stroke","black"),e.style.strokeWidth=`${t}px`,e.setAttribute("stroke-linejoin","round"),e.setAttribute("stroke-linecap","round"),e}(t.style.lineWidth);return s.setAttribute("x1",l[0].toString()),s.setAttribute("y1",l[1].toString()),s.setAttribute("x2",c[0].toString()),s.setAttribute("y2",c[1].toString()),i.appendChild(s),i}const q={icon:t.createElement("span",{style:{display:"inline-block",fontWeight:"bold",fontSize:"20px"}},"A"),id:"react-draw-textarea-tool",onDrawStart:t=>{!function(t){const e=12,n=5,{div:o,bounds:r}=t.container;r.bottom=r.top+e+n,o.style.height="",o.style.minHeight=r.bottom-r.top+"px",o.style.minWidth=o.style.width,o.style.width="",o.style.border="1px solid black",o.style.padding=n+"px",o.style.borderRadius="2px";const i=document.createElement("style");i.innerHTML="\n\t.react-draw-cursor {\n\t\toutline: none;\t\t\n\t\theight: 100%;\n\t}",o.appendChild(i);const l=function(){const t=document.createElement("div");return t.style.fontSize="14px",t.setAttribute("contenteditable","true"),t.style.minWidth="1px",t.style.height="100%",t.className="react-draw-cursor",t}();function c(){const t=o.getBoundingClientRect(),{width:e,height:n}=t;r.bottom=r.top+n,r.right=r.left+e,console.log("setting bounds on typing")}t.customData={handler:c},l.addEventListener("keypress",c),o.appendChild(l),V(o,r),l.setAttribute("tabindex","1"),setTimeout((function(){l.focus()}),0),t.element=l}(t)},onDrawing(t,e){},onDrawEnd(t,e){},onResize(t,e){},onSelect(t,e){const n=t.element;n&&(t.customData.handler&&(n.removeEventListener("keypress",t.customData.handler),t.customData.handler=null),F(n))},onUnSelect(t){V(t.container.div,t.container.bounds)},onAfterUpdate(t){const e=t.element;e&&F(e)}};function V(t,e){const n=t.getBoundingClientRect(),{width:o,height:r}=n;e.bottom=e.top+r,e.right=e.left+o}function F(t){if(t.focus(),void 0!==window.getSelection&&void 0!==document.createRange){var e=document.createRange();e.selectNodeContents(t),e.collapse(!1);const n=window.getSelection();if(n)return n.removeAllRanges(),n.addRange(e),!0}return console.error("cannot place caret at end"),!1}export{T as ReactDraw,H as circleTool,G as diamondTool,Z as freeDrawTool,U as selectTool,Y as squareTool,X as straightLineTool,q as textAreaTool};
